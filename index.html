<html>
<head>
  <title>main的博客</title>
  <style>
    body{
      margin: 0;
      padding: 0
    }
    nav{
      display: flex
    }
    nav>a{
      flex: 1
    }
    section{
      overflow: hidden
    }
    article{
      width: 100%;
      float: left;
    }
    article:not(:target){
      display: none
    }
    article:target{
      display: block
    }
    .loader-box{
      position: fixed;
      top: 0;
      bottom: 0;
      width: 100%;
      background-color: black;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .loader {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .loader {
      width: 10em;
      height: 10em;
      font-size: 28px;
      position: relative;
    }

    .loader span {
      position: absolute;
      background-color: rgba(100%, 0%, 0%, 0.3);
      box-sizing: border-box;
      border: 0.5em solid;
      border-color: white rgba(100%, 100%, 100%, 0.2);
      animation: animate 5s ease-in-out infinite alternate;
    }

    .loader span:nth-child(1) {
      width: calc(20% + 20% * (5 - 1));
      height: calc(20% + 20% * (5 - 1));
      animation-delay: calc(0.2s * (5 - 1));
    }

    .loader span:nth-child(2) {
      width: calc(20% + 20% * (5 - 2));
      height: calc(20% + 20% * (5 - 2));
      animation-delay: calc(0.2s * (5 - 2));
    }

    .loader span:nth-child(3) {
      width: calc(20% + 20% * (5 - 3));
      height: calc(20% + 20% * (5 - 3));
      animation-delay: calc(0.2s * (5 - 3));
    }

    .loader span:nth-child(4) {
      width: calc(20% + 20% * (5 - 4));
      height: calc(20% + 20% * (5 - 4));
      animation-delay: calc(0.2s * (5 - 4));
    }

    .loader span:nth-child(5) {
      width: calc(20% + 20% * (5 - 5));
      height: calc(20% + 20% * (5 - 5));
      animation-delay: calc(0.2s * (5 - 5));
    }

    @keyframes animate {
      0% {
        /* red */
        background-color: rgba(100%, 0%, 0%, 0.3);
        transform: rotate(0deg);
      }

      25% {
        /* yellow */
        background-color: rgba(100%, 100%, 0%, 0.3);
      }

      50% {
        /* green */
        background-color: rgba(0%, 100%, 0%, 0.3);
      }

      75% {
        /* blue */
        background-color: rgba(0%, 0%, 100%, 0.3);
      }

      100% {
        /* purple */
        background-color: rgba(100%, 0%, 100%, 0.3);
        transform: rotate(720deg);
      }
    }
  </style>
</head>
<body>
  <header>
    <h1 style="color: red;text-align: center">main2017的博客</h1>
    <nav>
      <a href="#page-one">首页</a>
      <a href="#page-two">文章</a>
      <a href="#page-three">个人说明</a>
  </nav>
  </header>
  <section>
    <article id="page-one"><a href="./webRtc.html">webRtc</article>
    <article id="page-two">page-two</article>
    <article id="page-three">page-three</article>
  </section>
  <video id="video"></video>
  <div class="loader-box">
    <div class="loader">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <script type="text/javascript">
    // 老的浏览器可能根本没有实现 mediaDevices，所以我们可以先设置一个空的对象
    if (navigator.mediaDevices === undefined) {
      navigator.mediaDevices = {};
    }

    // 一些浏览器部分支持 mediaDevices。我们不能直接给对象设置 getUserMedia
    // 因为这样可能会覆盖已有的属性。这里我们只会在没有getUserMedia属性的时候添加它。
    if (navigator.mediaDevices.getUserMedia === undefined) {
      navigator.mediaDevices.getUserMedia = function(constraints) {

        // 首先，如果有getUserMedia的话，就获得它
        var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

        // 一些浏览器根本没实现它 - 那么就返回一个error到promise的reject来保持一个统一的接口
        if (!getUserMedia) {
          return Promise.reject(new Error('getUserMedia is not implemented in this browser'));
        }

        // 否则，为老的navigator.getUserMedia方法包裹一个Promise
        return new Promise(function(resolve, reject) {
          getUserMedia.call(navigator, constraints, resolve, reject);
        });
      }
    }

    navigator.mediaDevices.getUserMedia({ audio: false, video: true })
      .then(function(stream) {
        var video = document.querySelector('video');
        // 旧的浏览器可能没有srcObject
        if ("srcObject" in video) {
          video.srcObject = stream;
        } else {
          // 防止再新的浏览器里使用它，应为它已经不再支持了
          video.src = window.URL.createObjectURL(stream);
        }
        video.onloadedmetadata = function(e) {
          video.play();
        };
      })
      .catch(function(err) {
        console.log(err.name + ": " + err.message);
      });
    function hideLoading() {
      let t = setTimeout(() => {
        document.querySelector('.loader-box').style.display = 'none'
        clearTimeout(t)
      }, 6000)
    }
    hideLoading()
  </script>
</body>
</html>
